//解析aardio界面生成Python Tkinter
import color
import string
import math
namespace GUI2Py
    
class GUI2Tk {
    ctor( winform ){
        this = winform;
    };
       
    //转换为主界面
    transfer2root = function(){
        var window_width = this.width;
        var window_height = this.height;
        var window_text = this.text;
        var pycode = /***
import tkinter as tk
import tkinter.ttk as ttk
import tkinter.font as tkFont
    
root = tk.Tk()
    
### 界面设计部分 ###
    
 
***/;
        pycode += 'root.geometry("'++ window_width ++ 'x' ++ window_height ++'")\r\n';
        pycode += 'root.title("'++ window_text ++'")\r\n';
        var ctrlNameList = {
            'button' = 0;
            'static' = 0;
            'edit' = 0;
            'radio' = 0;
            'check' = 0;
            'pic' = 0;
            'listbox' = 0;
            'combobox' = 0;
            'progress' = 0;
            'trackbar' = 0;
            'listview' = 0;
            'treeview' = 0;
            'canvas' = 0;
            'groupbox' = 0;
            'frame' = 0;
            'tab' = 0;
                
        };
        for ( hwnd,ctrl in this.eachControlEx() ){
            pycode += '# Z='++ctrl.z++'\r\n';
            winctrol = this.getCtrl(hwnd);
            var x = winctrol.left;
            var y = winctrol.top;
            var width = winctrol.width;
            var height = winctrol.height;
            var text = winctrol.text;
            var hide = ctrl.hide;
            var disabled = ctrl.disabled;
            var readonly = ctrl.readonly;
            var bgcolor = ctrl.bgcolor;
            var frcolor = ctrl.color;
            var font = ctrl.font;
            var align = ctrl.align;
            var justify;
            if !align {
                justify = ', justify="left"';
            } elseif align == "center" {
                justify = ', justify="center"';
            } else {
                justify = ', justify="right"';
            };
            //按钮
            if winctrol.cls == "button" {
                var id = ctrlNameList.button + 1;
                ctrlNameList.button = id;
                pycode += 'button'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                pycode += 'button'++id++ ' = ttk.Button(button'++id++'_frame, text="'++ text ++ '")\r\n';
                pycode += 'button'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'button'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'button'++id++ '.configure(state="disabled")\r\n'; };
                 
                pycode += 'button'++id++'_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //标签
            if winctrol.cls == "static" {
                var id = ctrlNameList.static + 1;
                ctrlNameList.static = id;
                pycode += 'label'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                pycode += 'label'++id++ ' = ttk.Label(label'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n';
                pycode += 'label'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'label'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'label'++id++ '.configure(state="disabled")\r\n'; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'label'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n';
                    pycode += 'label'++id++'.configure(font=label'++id++'_font)\r\n';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'label'++id++ '.config(background="'++bgcolorStr++'")\r\n';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'label'++id++ '.config(foreground="'++frcolorStr++'")\r\n';
                };
                pycode += 'label'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //文本框
            if winctrol.cls == "edit" {
                var id = ctrlNameList.edit + 1;
                ctrlNameList.edit = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                pycode += 'editVar' ++ id ++ " = tk.StringVar(value='"++ winctrol.text ++"')"++'\r\n';
                pycode += 'edit'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                if winctrol.multiline == 1 {
                    pycode += 'edit'++id++ ' = tk.Text(edit'++id++'_frame)\r\n';
                    pycode += 'edit'++id++ '.insert("end", "'++ winctrol.text ++ '")\r\n';
                } else {
                    pycode += 'edit'++id++ ' = ttk.Entry(edit'++id++'_frame, textvariable=editVar'++id++justify++')\r\n';
                }
                pycode += 'edit'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if ctrl.password { pycode += 'edit'++id++ '.configure(show="*")\r\n'; };
                if(readonly or disabled) { pycode += 'edit'++id++ '.configure(state="disabled")\r\n'; };
                if hide { pycode += 'edit'++id++ '.place_forget()\r\n'; };
                if vscroll {
                    pycode += 'edit'++id++'_vscroll = tk.Scrollbar(edit'++id++', orient="vertical", command=edit'++id++'.yview)\r\n';
                    pycode += 'edit'++id++'.configure(yscrollcommand=edit'++id++'_vscroll.set)\r\n';
                    pycode += 'edit'++id++'_vscroll.pack(side="right", fill="y")\r\n';
                };
                if hscroll {
                    pycode += 'edit'++id++'_hscroll = tk.Scrollbar(edit'++id++', orient="horizontal", command=edit'++id++'.xview)\r\n';
                    pycode += 'edit'++id++'.configure(xscrollcommand=edit'++id++'_hscroll.set)\r\n';
                    pycode += 'edit'++id++'_hscroll.pack(side="bottom", fill="x")\r\n';
                };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'edit'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n';
                    pycode += 'edit'++id++'.configure(font=edit'++id++'_font)\r\n';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'edit'++id++ '.config(background="'++bgcolorStr++'")\r\n';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'edit'++id++ '.config(foreground="'++frcolorStr++'")\r\n';
                };
                pycode += 'edit'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //单选
            if winctrol.cls == "radiobutton" {
                var id = ctrlNameList.radio + 1;
                ctrlNameList.radio = id;
                pycode += 'radio'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                pycode += 'radio'++id++ ' = ttk.Radiobutton(radio'++id++'_frame, text="'++ text ++'"' ++ justify ++ ')\r\n';
                pycode += 'radio'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'radio'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'radio'++id++ '.configure(state="disabled")\r\n'; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'radio'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n';
                    pycode += 'radio'++id++'.configure(font=radio'++id++'_font)\r\n';
                };
                pycode += 'radio'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //复选
            if winctrol.cls == "checkbox" {
                var id = ctrlNameList.check + 1;
                ctrlNameList.check = id;
                pycode += 'check'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                pycode += 'check'++id++ ' = ttk.Checkbutton(check'++id++'_frame, text="'++ text ++'"'++justify++')\r\n';
                pycode += 'check'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'check'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'check'++id++ '.configure(state="disabled")\r\n'; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'check'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n';
                    pycode += 'check'++id++'.configure(font=check'++id++'_font)\r\n';
                };
                pycode += 'check'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //图片框
            if winctrol.cls == "picturebox" {
                var id = ctrlNameList.pic + 1;
                ctrlNameList.pic = id;
                pycode += 'pic'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                var picpath = winctrol.background;
                if picpath {
                    pycode += 'img' ++ id ++ " = tk.PhotoImage(file=r'"++ picpath.path ++"')"++'\r\n';
                    pycode += 'pic' ++ id ++ ' = ttk.Label(pic'++id++'_frame, image=img'++ id ++justify++')\r\n';
                } else {
                    pycode += 'pic'++id++ ' = ttk.Label(pic'++id++'_frame'++justify++')\r\n';
                }
                pycode += 'pic'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'pic'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'pic'++id++ '.configure(state="disabled")\r\n'; };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'pic'++id++ '.config(background="'++bgcolorStr++'")\r\n';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'pic'++id++ '.config(foreground="'++frcolorStr++'")\r\n';
                };
                pycode += 'pic'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //画板
            if winctrol.cls == "plus" {
                var id = ctrlNameList.canvas + 1;
                ctrlNameList.canvas = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                var bgcolor = winctrol.backgroundColor;
                pycode += 'canvas'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                pycode += 'canvas'++id++ ' = tk.Canvas(canvas'++id++'_frame)\r\n';
                pycode += 'canvas'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'canvas'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'canvas'++id++ '.configure(state="disabled")\r\n'; };
                if vscroll {
                    pycode += 'canvas'++id++'_vscroll = tk.Scrollbar(canvas'++id++', orient="vertical", command=canvas'++id++'.yview)\r\n';
                    pycode += 'canvas'++id++'.configure(yscrollcommand=canvas'++id++'_vscroll.set)\r\n';
                    pycode += 'canvas'++id++'_vscroll.pack(side="right", fill="y")\r\n';
                };
                if hscroll {
                    pycode += 'canvas'++id++'_hscroll = tk.Scrollbar(canvas'++id++', orient="horizontal", command=canvas'++id++'.xview)\r\n';
                    pycode += 'canvas'++id++'.configure(xscrollcommand=canvas'++id++'_hscroll.set)\r\n';
                    pycode += 'canvas'++id++'_hscroll.pack(side="bottom", fill="x")\r\n';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    bStr = ..string.slice(bgcolorStr,2,3);
                    gStr = ..string.slice(bgcolorStr,4,5);
                    rStr = ..string.slice(bgcolorStr,6,7);
                    pycode += 'canvas'++id++ '.config(background="#'++rStr++gStr++bStr++'")\r\n';
                };
                pycode += 'canvas'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //ListBox
            if winctrol.cls == "listbox" {
                var id = ctrlNameList.listbox + 1;
                ctrlNameList.listbox = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                pycode += 'list'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                var items = winctrol.items;
                if #items>0 {
                    pycode += 'items'++id++' = tk.Variable(value=[';
                    for i,item in items {
                        pycode += '"' ++ item ++'", ';
                    }
                    pycode += '])\r\n';
                    pycode += 'list'++id++ ' = tk.Listbox(list'++id++'_frame, listvariable=items'++ id ++ justify ++')\r\n';
                       
                } else {
                    pycode += 'list'++id++ ' = tk.Listbox(list'++id++'_frame'++justify++')\r\n';
                }
                pycode += 'list'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'list'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'list'++id++ '.configure(state="disabled")\r\n'; };
                if vscroll {
                    pycode += 'list'++id++'_vscroll = tk.Scrollbar(list'++id++', orient="vertical", command=list'++id++'.yview)\r\n';
                    pycode += 'list'++id++'.configure(yscrollcommand=list'++id++'_vscroll.set)\r\n';
                    pycode += 'list'++id++'_vscroll.pack(side="right", fill="y")\r\n';
                };
                if hscroll {
                    pycode += 'list'++id++'_hscroll = tk.Scrollbar(list'++id++', orient="horizontal", command=list'++id++'.xview)\r\n';
                    pycode += 'list'++id++'.configure(xscrollcommand=list'++id++'_hscroll.set)\r\n';
                    pycode += 'list'++id++'_hscroll.pack(side="bottom", fill="x")\r\n';
                };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'list'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n';
                    pycode += 'list'++id++'.configure(font=list'++id++'_font)\r\n';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'list'++id++ '.config(background="'++bgcolorStr++'")\r\n';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'list'++id++ '.config(foreground="'++frcolorStr++'")\r\n';
                };
                pycode += 'list'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //下拉框
            if winctrol.cls == "combobox" {
                var id = ctrlNameList.combobox + 1;
                ctrlNameList.combobox = id;
                pycode += 'combobox'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                var items = winctrol.items;
                if #items>0 {
                    pycode += 'combobox'++id++ '= ttk.Combobox(combobox'++id++'_frame, value=[';
                    for i,item in items {
                        pycode += '"' ++ item ++'", ';
                    }
                    pycode += ']'++justify++')\r\n';
                       
                } else {
                    pycode += 'combobox'++id++ ' = ttk.Combobox(combobox'++id++'_frame'++justify++')\r\n';
                }
                pycode += 'combobox'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'combobox'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'combobox'++id++ '.configure(state="disabled")\r\n'; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'combobox'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n';
                    pycode += 'combobox'++id++'.configure(font=combobox'++id++'_font)\r\n';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'combobox'++id++ '.config(background="'++bgcolorStr++'")\r\n';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'combobox'++id++ '.config(foreground="'++frcolorStr++'")\r\n';
                };
                pycode += 'combobox'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //表格
            if winctrol.cls == "listview" {
                var id = ctrlNameList.treeview + 1;
                ctrlNameList.treeview = id;
                pycode += 'tree'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                pycode += 'tree'++id++ ' = ttk.Treeview(tree'++id++'_frame)\r\n';
                pycode += 'tree'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'tree'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'tree'++id++ '.configure(state="disabled")\r\n'; };
                pycode += 'tree'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //进度条
            if winctrol.cls == "progress" {
                var id = ctrlNameList.progress + 1;
                ctrlNameList.progress = id;
                pycode += 'progress'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                var max = winctrol.max;
                var value = winctrol.pos;
                pycode += 'progress'++id++ ' = ttk.Progressbar(progress'++id++'_frame, value='++ value ++', maximum='++ max ++')\r\n';
                pycode += 'progress'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'progress'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'progress'++id++ '.configure(state="disabled")\r\n'; };
                pycode += 'progress'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //Trackbar
            if winctrol.cls == "trackbar" {
                var id = ctrlNameList.trackbar + 1;
                ctrlNameList.trackbar = id;
                pycode += 'scale'++id++'_frame = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                var min = winctrol.min;
                var max = winctrol.max;
                var value = winctrol.pos;
                pycode += 'scale'++id++ ' = ttk.Scale(scale'++id++'_frame, from_='++ min ++', to='++ max ++', value='++ value ++ ')\r\n';
                pycode += 'scale'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'scale'++id++ '.place_forget()\r\n'; };
                if disabled { pycode += 'scale'++id++ '.configure(state="disabled")\r\n'; };
                pycode += 'scale'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n';
            };
            //GroupBox
            if winctrol.cls == "groupbox" {
                var id = ctrlNameList.groupbox + 1;
                ctrlNameList.groupbox = id;
                pycode += 'labelframe'++id++ ' = ttk.Labelframe(text="'++ text ++'", width='++ width ++', height='++ height ++')\r\n';
                pycode += 'labelframe'++id++ '.place(x='++ x ++', y='++ y ++', width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'labelframe'++id++ '.place_forget()\r\n'; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'labelframe'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n';
                    pycode += 'labelframe'++id++'.configure(font=labelframe'++id++'_font)\r\n';
                };
            };
            //Frame
            if winctrol.cls == "custom" {
                var id = ctrlNameList.frame + 1;
                ctrlNameList.frame = id;
                pycode += 'frame'++id++ ' = ttk.Frame(width='++ width ++', height='++ height ++')\r\n';
                pycode += 'frame'++id++ '.place(x='++ x ++', y='++ y ++', width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'frame'++id++ '.place_forget()\r\n'; };
            };
            //Tab
            if winctrol.cls == "tab" {
                var id = ctrlNameList.tab + 1;
                ctrlNameList.tab = id;
                pycode += 'nb'++id++ ' = ttk.Notebook(width='++ width ++', height='++ height ++')\r\n';
                pycode += 'nb'++id++ '.place(x='++ x ++', y='++ y ++', width='++ width ++', height='++ height ++')\r\n';
                if hide { pycode += 'nb'++id++ '.place_forget()\r\n'; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'nb'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n';
                    pycode += 'nb'++id++'.configure(font=nb'++id++'_font)\r\n';
                };
            };
        };
            
        pycode += '\r\n\r\n### 功能逻辑部分 ###\r\n\r\n';
            
        pycode += 'root.mainloop()\r\n';
            
        return pycode;
    };
       
    //转换为组件
    transfer2place = function(assembly_name="SubAssembly"){
        var window_width = this.width;
        var window_height = this.height;
        var window_text = this.text;
        var pycode = /***
import tkinter as tk
import tkinter.ttk as ttk
import tkinter.font as tkFont
   
class ***/
        pycode += assembly_name++'():\r\n    ### 界面设计部分 ###\r\n    \r\n    def __init__(self, master):\r\n        '
        pycode += 'self.mainframe = ttk.Frame(master, width='++ window_width ++', height='++ window_height ++')\r\n        ';
        var ctrlNameList = {
            'button' = 0;
            'static' = 0;
            'edit' = 0;
            'radio' = 0;
            'check' = 0;
            'pic' = 0;
            'listbox' = 0;
            'combobox' = 0;
            'progress' = 0;
            'trackbar' = 0;
            'listview' = 0;
            'treeview' = 0;
            'canvas' = 0;
            'groupbox' = 0;
            'frame' = 0;
            'tab' = 0;
                
        };
        for ( hwnd,ctrl in this.eachControlEx() ){
            pycode += '# Z='++ctrl.z++'\r\n        ';
            winctrol = this.getCtrl(hwnd);
            var x = winctrol.left;
            var y = winctrol.top;
            var width = winctrol.width;
            var height = winctrol.height;
            var text = winctrol.text;
            var hide = ctrl.hide;
            var disabled = ctrl.disabled;
            var readonly = ctrl.readonly;
            var bgcolor = ctrl.bgcolor;
            var frcolor = ctrl.color;
            var font = ctrl.font;
            var align = ctrl.align;
            var justify;
            if !align {
                justify = ', justify="left"';
            } elseif align == "center" {
                justify = ', justify="center"';
            } else {
                justify = ', justify="right"';
            };
            //按钮
            if winctrol.cls == "button" {
                var id = ctrlNameList.button + 1;
                ctrlNameList.button = id;
                pycode += 'self.button'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.button'++id++ ' = ttk.Button(self.button'++id++'_frame, text="'++ text ++'")\r\n        ';
                pycode += 'self.button'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.button'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.button'++id++ '.configure(state="disabled")\r\n        '; };
                 
                pycode += 'self.button'++id++'_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
               
            //标签
            if winctrol.cls == "static" {
                var id = ctrlNameList.static + 1;
                ctrlNameList.static = id;
                pycode += 'self.label'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.label'++id++ ' = ttk.Label(self.label'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.label'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.label'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.label'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.label'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.label'++id++'.configure(font=self.label'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.label'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.label'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.label'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
               
            //文本框
            if winctrol.cls == "edit" {
                var id = ctrlNameList.edit + 1;
                ctrlNameList.edit = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                pycode += 'self.editVar' ++ id ++ " = tk.StringVar(value='"++ winctrol.text ++"')"++'\r\n        ';
                pycode += 'self.edit'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                if winctrol.multiline == 1 {
                    pycode += 'self.edit'++id++ ' = tk.Text(self.edit'++id++'_frame)\r\n        ';
                    pycode += 'self.edit'++id++ '.insert("end", "'++ winctrol.text ++ '")\r\n        ';
                } else {
                    pycode += 'self.edit'++id++ ' = ttk.Entry(self.edit'++id++'_frame, textvariable=self.editVar'++id++ justify ++')\r\n        ';
                }
                pycode += 'self.edit'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if ctrl.password { pycode += 'self.edit'++id++ '.configure(show="*")\r\n        '; };
                if hide { pycode += 'self.edit'++id++ '.place_forget()\r\n        '};
                if(readonly or disabled) { pycode += 'self.edit'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.edit'++id++'_vscroll = tk.Scrollbar(self.edit'++id++', orient="vertical", command=self.edit'++id++'.yview)\r\n        ';
                    pycode += 'self.edit'++id++'.configure(yscrollcommand=self.edit'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.edit'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.edit'++id++'_hscroll = tk.Scrollbar(self.edit'++id++', orient="horizontal", command=self.edit'++id++'.xview)\r\n        ';
                    pycode += 'self.edit'++id++'.configure(xscrollcommand=self.edit'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.edit'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.edit'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.edit'++id++'.configure(font=self.edit'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.edit'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.edit'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.edit'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
               
            //单选
            if winctrol.cls == "radiobutton" {
                var id = ctrlNameList.radio + 1;
                ctrlNameList.radio = id;
                pycode += 'self.radio'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.radio'++id++ ' = ttk.Radiobutton(self.radio'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.radio'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.radio'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.radio'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.radio'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.radio'++id++'.configure(font=self.radio'++id++'_font)\r\n        ';
                };
                pycode += 'self.radio'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
               
            //复选
            if winctrol.cls == "checkbox" {
                var id = ctrlNameList.check + 1;
                ctrlNameList.check = id;
                pycode += 'self.check'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.check'++id++ ' = ttk.Checkbutton(self.check'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.check'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.check'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.check'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.check'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.check'++id++'.configure(font=self.check'++id++'_font)\r\n        ';
                };
                pycode += 'self.check'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
               
            //图片框
            if winctrol.cls == "picturebox" {
                var id = ctrlNameList.pic + 1;
                ctrlNameList.pic = id;
                pycode += 'self.pic'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var picpath = winctrol.background;
                if picpath {
                    pycode += 'self.img' ++ id ++ " = tk.PhotoImage(file=r'"++ picpath.path ++"')"++'\r\n        ';
                    pycode += 'self.pic' ++ id ++ ' = ttk.Label(self.pic'++id++'_frame, image=self.img'++ id ++ justify ++')\r\n        ';
                } else {
                    pycode += 'self.pic'++id++ ' = ttk.Label(self.pic'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.pic'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.pic'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.pic'++id++ '.configure(state="disabled")\r\n        '; };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.pic'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.pic'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.pic'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
              
            //画板
            if winctrol.cls == "plus" {
                var id = ctrlNameList.canvas + 1;
                ctrlNameList.canvas = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                var bgcolor = winctrol.backgroundColor;
                pycode += 'self.canvas'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.canvas'++id++ ' = tk.Canvas(self.canvas'++id++'_frame)\r\n        ';
                pycode += 'self.canvas'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.canvas'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.canvas'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.canvas'++id++'_vscroll = tk.Scrollbar(self.canvas'++id++', orient="vertical", command=self.canvas'++id++'.yview)\r\n        ';
                    pycode += 'self.canvas'++id++'.configure(yscrollcommand=self.canvas'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.canvas'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.canvas'++id++'_hscroll = tk.Scrollbar(self.canvas'++id++', orient="horizontal", command=self.canvas'++id++'.xview)\r\n        ';
                    pycode += 'self.canvas'++id++'.configure(xscrollcommand=self.canvas'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.canvas'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    bStr = ..string.slice(bgcolorStr,2,3);
                    gStr = ..string.slice(bgcolorStr,4,5);
                    rStr = ..string.slice(bgcolorStr,6,7);
                    pycode += 'self.canvas'++id++ '.config(background="#'++rStr++gStr++bStr++'")\r\n        ';
                };
                pycode += 'self.canvas'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
              
            //ListBox
            if winctrol.cls == "listbox" {
                var id = ctrlNameList.listbox + 1;
                ctrlNameList.listbox = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                pycode += 'self.list'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var items = winctrol.items;
                if #items>0 {
                    pycode += 'self.items'++id++' = tk.Variable(value=[';
                    for i,item in items {
                        pycode += '"' ++ item ++'", ';
                    }
                    pycode += '])\r\n        ';
                    pycode += 'self.list'++id++ ' = tk.Listbox(self.list'++id++'_frame, listvariable=self.items'++ id ++ justify ++')\r\n        ';
                       
                } else {
                    pycode += 'self.list'++id++ ' = tk.Listbox(self.list'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.list'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.list'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.list'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.list'++id++'_vscroll = tk.Scrollbar(self.list'++id++', orient="vertical", command=self.list'++id++'.yview)\r\n        ';
                    pycode += 'self.list'++id++'.configure(yscrollcommand=self.list'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.list'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.list'++id++'_hscroll = tk.Scrollbar(self.list'++id++', orient="horizontal", command=self.list'++id++'.xview)\r\n        ';
                    pycode += 'self.list'++id++'.configure(xscrollcommand=self.list'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.list'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.list'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.list'++id++'.configure(font=self.list'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.list'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.list'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.list'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
               
            //下拉框
            if winctrol.cls == "combobox" {
                var id = ctrlNameList.combobox + 1;
                ctrlNameList.combobox = id;
                pycode += 'self.combobox'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var items = winctrol.items;
                if #items>0 {
                    pycode += 'self.combobox'++id++ '= ttk.Combobox(self.combobox'++id++'_frame, value=[';
                    for i,item in items {
                        pycode += '"' ++ item ++'", ';
                    }
                    pycode += ']'++ justify ++')\r\n        ';
                       
                } else {
                    pycode += 'self.combobox'++id++ ' = ttk.Combobox(self.combobox'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.combobox'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.combobox'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.combobox'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.combobox'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.combobox'++id++'.configure(font=self.combobox'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.combobox'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.combobox'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.combobox'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
              
            //表格
            if winctrol.cls == "listview" {
                var id = ctrlNameList.treeview + 1;
                ctrlNameList.treeview = id;
                pycode += 'self.tree'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.tree'++id++ ' = ttk.Treeview(self.tree'++id++'_frame)\r\n        ';
                pycode += 'self.tree'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.tree'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.tree'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.tree'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
              
            //进度条
            if winctrol.cls == "progress" {
                var id = ctrlNameList.progress + 1;
                ctrlNameList.progress = id;
                pycode += 'self.progress'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var max = winctrol.max;
                var value = winctrol.pos;
                pycode += 'self.progress'++id++ ' = ttk.Progressbar(self.progress'++id++'_frame, value='++ value ++', maximum='++ max ++')\r\n        ';
                pycode += 'self.progress'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.progress'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.progress'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.progress'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
               
            //Trackbar
            if winctrol.cls == "trackbar" {
                var id = ctrlNameList.trackbar + 1;
                ctrlNameList.trackbar = id;
                pycode += 'self.scale'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var min = winctrol.min;
                var max = winctrol.max;
                var value = winctrol.pos;
                pycode += 'self.scale'++id++ ' = ttk.Scale(self.scale'++id++'_frame, from_='++ min ++', to='++ max ++', value='++ value ++ ')\r\n        ';
                pycode += 'self.scale'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.scale'++id++ '.place_forget()\r\n        '};
                if disabled { pycode += 'self.scale'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.scale'++id++ '_frame.place(x='++ x ++', y='++ y ++')\r\n        ';
            };
               
            //GroupBox
            if winctrol.cls == "groupbox" {
                var id = ctrlNameList.groupbox + 1;
                ctrlNameList.groupbox = id;
                pycode += 'self.labelframe'++id++ ' = ttk.Labelframe(self.mainframe, text="'++ text ++'", width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.labelframe'++id++ '.place(x='++ x ++', y='++ y ++', width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.labelframe'++id++ '.place_forget()\r\n        '};
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.labelframe'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.labelframe'++id++'.configure(font=self.labelframe'++id++'_font)\r\n        ';
                };
            };
               
            //Frame
            if winctrol.cls == "custom" {
                var id = ctrlNameList.frame + 1;
                ctrlNameList.frame = id;
                pycode += 'self.frame'++id++ ' = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.frame'++id++ '.place(x='++ x ++', y='++ y ++', width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.frame'++id++ '.place_forget()\r\n        '};
            };
               
            //Tab
            if winctrol.cls == "tab" {
                var id = ctrlNameList.tab + 1;
                ctrlNameList.tab = id;
                pycode += 'self.nb'++id++ ' = ttk.Notebook(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.nb'++id++ '.place(x='++ x ++', y='++ y ++', width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.nb'++id++ '.place_forget()\r\n        '};
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.nb'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.nb'++id++'.configure(font=self.nb'++id++'_font)\r\n        ';
                };
            };
        };
          
        pycode += 'self.mainframe.pack()\r\n        ';
          
        pycode += '\r\n    ### 功能逻辑部分 ###\r\n        \r\n        \r\n        ';
          
        return pycode;
    };
     
    //转换为组件(pack方式)
    transfer2pack = function(assembly_name="SubAssembly"){
        var window_width = this.width;
        var window_height = this.height;
        var window_text = this.text;
        var pycode = /***
import tkinter as tk
import tkinter.ttk as ttk
import tkinter.font as tkFont
 
class ***/
        pycode += assembly_name++'():\r\n    ### 界面设计部分 ###\r\n    \r\n    def __init__(self, master):\r\n        '
        pycode += 'self.mainframe = ttk.Frame(master, width='++ window_width ++', height='++ window_height ++')\r\n        ';
        var ctrlNameList = {
            'button' = 0;
            'static' = 0;
            'edit' = 0;
            'radio' = 0;
            'check' = 0;
            'pic' = 0;
            'listbox' = 0;
            'combobox' = 0;
            'progress' = 0;
            'trackbar' = 0;
            'listview' = 0;
            'treeview' = 0;
            'canvas' = 0;
            'groupbox' = 0;
            'frame' = 0;
            'tab' = 0;
                
        };
        for ( hwnd,ctrl in this.eachControlEx() ){
            pycode += '# Z='++ctrl.z++'\r\n        ';
            winctrol = this.getCtrl(hwnd);
            var width = winctrol.width;
            var height = winctrol.height;
            var text = winctrol.text;
            var hide = ctrl.hide;
            var disabled = ctrl.disabled;
            var readonly = ctrl.readonly;
            var bgcolor = ctrl.bgcolor;
            var frcolor = ctrl.color;
            var font = ctrl.font;
            var align = ctrl.align;
            var justify;
            if !align {
                justify = ', justify="left"';
            } elseif align == "center" {
                justify = ', justify="center"';
            } else {
                justify = ', justify="right"';
            };
            //按钮
            if winctrol.cls == "button" {
                var id = ctrlNameList.button + 1;
                ctrlNameList.button = id;
                pycode += 'self.button'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.button'++id++ ' = ttk.Button(self.button'++id++'_frame, text="'++ text ++'")\r\n        ';
                pycode += 'self.button'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.button'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.button'++id++ '.configure(state="disabled")\r\n        '; };
                 
                pycode += 'self.button'++id++'_frame.pack()\r\n        ';
            };
               
            //标签
            if winctrol.cls == "static" {
                var id = ctrlNameList.static + 1;
                ctrlNameList.static = id;
                pycode += 'self.label'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.label'++id++ ' = ttk.Label(self.label'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.label'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.label'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.label'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.label'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.label'++id++'.configure(font=self.label'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.label'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.label'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.label'++id++ '_frame.pack()\r\n        ';
            };
               
            //文本框
            if winctrol.cls == "edit" {
                var id = ctrlNameList.edit + 1;
                ctrlNameList.edit = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                pycode += 'self.editVar' ++ id ++ " = tk.StringVar(value='"++ winctrol.text ++"')"++'\r\n        ';
                pycode += 'self.edit'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                if winctrol.multiline == 1 {
                    pycode += 'self.edit'++id++ ' = tk.Text(self.edit'++id++'_frame)\r\n        ';
                    pycode += 'self.edit'++id++ '.insert("end", "'++ winctrol.text ++ '")\r\n        ';
                } else {
                    pycode += 'self.edit'++id++ ' = ttk.Entry(self.edit'++id++'_frame, textvariable=self.editVar'++id++ justify ++')\r\n        ';
                }
                pycode += 'self.edit'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if ctrl.password { pycode += 'self.edit'++id++ '.configure(show="*")\r\n        '; };
                if hide { pycode += 'self.edit'++id++ '.place_forget()\r\n        '; };
                if(readonly or disabled) { pycode += 'self.edit'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.edit'++id++'_vscroll = tk.Scrollbar(self.edit'++id++', orient="vertical", command=self.edit'++id++'.yview)\r\n        ';
                    pycode += 'self.edit'++id++'.configure(yscrollcommand=self.edit'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.edit'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.edit'++id++'_hscroll = tk.Scrollbar(self.edit'++id++', orient="horizontal", command=self.edit'++id++'.xview)\r\n        ';
                    pycode += 'self.edit'++id++'.configure(xscrollcommand=self.edit'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.edit'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.edit'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.edit'++id++'.configure(font=self.edit'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.edit'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.edit'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.edit'++id++ '_frame.pack()\r\n        ';
            };
               
            //单选
            if winctrol.cls == "radiobutton" {
                var id = ctrlNameList.radio + 1;
                ctrlNameList.radio = id;
                pycode += 'self.radio'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.radio'++id++ ' = ttk.Radiobutton(self.radio'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.radio'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.radio'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.radio'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.radio'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.radio'++id++'.configure(font=self.radio'++id++'_font)\r\n        ';
                };
                pycode += 'self.radio'++id++ '_frame.pack()\r\n        ';
            };
               
            //复选
            if winctrol.cls == "checkbox" {
                var id = ctrlNameList.check + 1;
                ctrlNameList.check = id;
                pycode += 'self.check'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.check'++id++ ' = ttk.Checkbutton(self.check'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.check'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.check'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.check'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.check'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.check'++id++'.configure(font=self.check'++id++'_font)\r\n        ';
                };
                pycode += 'self.check'++id++ '_frame.pack()\r\n        ';
            };
               
            //图片框
            if winctrol.cls == "picturebox" {
                var id = ctrlNameList.pic + 1;
                ctrlNameList.pic = id;
                pycode += 'self.pic'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var picpath = winctrol.background;
                if picpath {
                    pycode += 'self.img' ++ id ++ " = tk.PhotoImage(file=r'"++ picpath.path ++"')"++'\r\n        ';
                    pycode += 'self.pic' ++ id ++ ' = ttk.Label(self.pic'++id++'_frame, image=self.img'++ id ++ justify ++')\r\n        ';
                } else {
                    pycode += 'self.pic'++id++ ' = ttk.Label(self.pic'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.pic'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.pic'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.pic'++id++ '.configure(state="disabled")\r\n        '; };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.pic'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.pic'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.pic'++id++ '_frame.pack()\r\n        ';
            };
              
            //画板
            if winctrol.cls == "plus" {
                var id = ctrlNameList.canvas + 1;
                ctrlNameList.canvas = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                var bgcolor = winctrol.backgroundColor;
                pycode += 'self.canvas'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.canvas'++id++ ' = tk.Canvas(self.canvas'++id++'_frame)\r\n        ';
                pycode += 'self.canvas'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.canvas'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.canvas'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.canvas'++id++'_vscroll = tk.Scrollbar(self.canvas'++id++', orient="vertical", command=self.canvas'++id++'.yview)\r\n        ';
                    pycode += 'self.canvas'++id++'.configure(yscrollcommand=self.canvas'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.canvas'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.canvas'++id++'_hscroll = tk.Scrollbar(self.canvas'++id++', orient="horizontal", command=self.canvas'++id++'.xview)\r\n        ';
                    pycode += 'self.canvas'++id++'.configure(xscrollcommand=self.canvas'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.canvas'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    bStr = ..string.slice(bgcolorStr,2,3);
                    gStr = ..string.slice(bgcolorStr,4,5);
                    rStr = ..string.slice(bgcolorStr,6,7);
                    pycode += 'self.canvas'++id++ '.config(background="#'++rStr++gStr++bStr++'")\r\n        ';
                };
                pycode += 'self.canvas'++id++ '_frame.pack()\r\n        ';
            };
              
            //ListBox
            if winctrol.cls == "listbox" {
                var id = ctrlNameList.listbox + 1;
                ctrlNameList.listbox = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                pycode += 'self.list'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var items = winctrol.items;
                if #items>0 {
                    pycode += 'self.items'++id++' = tk.Variable(value=[';
                    for i,item in items {
                        pycode += '"' ++ item ++'", ';
                    }
                    pycode += '])\r\n        ';
                    pycode += 'self.list'++id++ ' = tk.Listbox(self.list'++id++'_frame, listvariable=self.items'++ id ++ justify ++')\r\n        ';
                       
                } else {
                    pycode += 'self.list'++id++ ' = tk.Listbox(self.list'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.list'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.list'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.list'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.list'++id++'_vscroll = tk.Scrollbar(self.list'++id++', orient="vertical", command=self.list'++id++'.yview)\r\n        ';
                    pycode += 'self.list'++id++'.configure(yscrollcommand=self.list'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.list'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.list'++id++'_hscroll = tk.Scrollbar(self.list'++id++', orient="horizontal", command=self.list'++id++'.xview)\r\n        ';
                    pycode += 'self.list'++id++'.configure(xscrollcommand=self.list'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.list'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.list'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.list'++id++'.configure(font=self.list'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.list'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.list'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.list'++id++ '_frame.pack()\r\n        ';
            };
               
            //下拉框
            if winctrol.cls == "combobox" {
                var id = ctrlNameList.combobox + 1;
                ctrlNameList.combobox = id;
                pycode += 'self.combobox'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var items = winctrol.items;
                if #items>0 {
                    pycode += 'self.combobox'++id++ '= ttk.Combobox(self.combobox'++id++'_frame, value=[';
                    for i,item in items {
                        pycode += '"' ++ item ++'", ';
                    }
                    pycode += ']'++ justify ++')\r\n        ';
                       
                } else {
                    pycode += 'self.combobox'++id++ ' = ttk.Combobox(self.combobox'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.combobox'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.combobox'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.combobox'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.combobox'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.combobox'++id++'.configure(font=self.combobox'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.combobox'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.combobox'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.combobox'++id++ '_frame.pack()\r\n        ';
            };
              
            //表格
            if winctrol.cls == "listview" {
                var id = ctrlNameList.treeview + 1;
                ctrlNameList.treeview = id;
                pycode += 'self.tree'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.tree'++id++ ' = ttk.Treeview(self.tree'++id++'_frame)\r\n        ';
                pycode += 'self.tree'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.tree'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.tree'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.tree'++id++ '_frame.pack()\r\n        ';
            };
              
            //进度条
            if winctrol.cls == "progress" {
                var id = ctrlNameList.progress + 1;
                ctrlNameList.progress = id;
                pycode += 'self.progress'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var max = winctrol.max;
                var value = winctrol.pos;
                pycode += 'self.progress'++id++ ' = ttk.Progressbar(self.progress'++id++'_frame, value='++ value ++', maximum='++ max ++')\r\n        ';
                pycode += 'self.progress'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.progress'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.progress'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.progress'++id++ '_frame.pack()\r\n        ';
            };
               
            //Trackbar
            if winctrol.cls == "trackbar" {
                var id = ctrlNameList.trackbar + 1;
                ctrlNameList.trackbar = id;
                pycode += 'self.scale'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var min = winctrol.min;
                var max = winctrol.max;
                var value = winctrol.pos;
                pycode += 'self.scale'++id++ ' = ttk.Scale(self.scale'++id++'_frame, from_='++ min ++', to='++ max ++', value='++ value ++ ')\r\n        ';
                pycode += 'self.scale'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.scale'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.scale'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.scale'++id++ '_frame.pack()\r\n        ';
            };
               
            //GroupBox
            if winctrol.cls == "groupbox" {
                var id = ctrlNameList.groupbox + 1;
                ctrlNameList.groupbox = id;
                pycode += 'self.labelframe'++id++ ' = ttk.Labelframe(self.mainframe, text="'++ text ++'", width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.labelframe'++id++ '.pack()\r\n        ';
                if hide { pycode += 'self.labelframe'++id++ '.pack_forget()\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.labelframe'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.labelframe'++id++'.configure(font=self.labelframe'++id++'_font)\r\n        ';
                };
            };
               
            //Frame
            if winctrol.cls == "custom" {
                var id = ctrlNameList.frame + 1;
                ctrlNameList.frame = id;
                pycode += 'self.frame'++id++ ' = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.frame'++id++ '.pack()\r\n        ';
                if hide { pycode += 'self.frame'++id++ '.pack_forget()\r\n        '; }; 
            };
               
            //Tab
            if winctrol.cls == "tab" {
                var id = ctrlNameList.tab + 1;
                ctrlNameList.tab = id;
                pycode += 'self.nb'++id++ ' = ttk.Notebook(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.nb'++id++ '.pack()\r\n        ';
                if hide { pycode += 'self.nb'++id++ '.pack_forget()\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.nb'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.nb'++id++'.configure(font=self.nb'++id++'_font)\r\n        ';
                };
            };
        };
          
        pycode += 'self.mainframe.pack()\r\n';
          
        pycode += '\r\n    ### 功能逻辑部分 ###\r\n        \r\n        \r\n        ';
          
        return pycode;
    };
     
    //转换为组件(grid方式)
    transfer2grid = function(assembly_name="SubAssembly"){
        var window_width = this.width;
        var window_height = this.height;
        var window_text = this.text;
        var pycode = /***
import tkinter as tk
import tkinter.ttk as ttk
import tkinter.font as tkFont
 
class ***/
        pycode += assembly_name++'():\r\n    ### 界面设计部分 ###\r\n    \r\n    def __init__(self, master):\r\n        '
        pycode += 'self.mainframe = ttk.Frame(master, width='++ window_width ++', height='++ window_height ++')\r\n        ';
        var ctrlNameList = {
            'button' = 0;
            'static' = 0;
            'edit' = 0;
            'radio' = 0;
            'check' = 0;
            'pic' = 0;
            'listbox' = 0;
            'combobox' = 0;
            'progress' = 0;
            'trackbar' = 0;
            'listview' = 0;
            'treeview' = 0;
            'canvas' = 0;
            'groupbox' = 0;
            'frame' = 0;
            'tab' = 0;
                
        };
        var col = 0;
        var row = 0;
        for ( hwnd,ctrl in this.eachControlEx() ){
            pycode += '# Z='++ctrl.z++'\r\n        ';
            winctrol = this.getCtrl(hwnd);
            var width = winctrol.width;
            var height = winctrol.height;
            var text = winctrol.text;
            var hide = ctrl.hide;
            var disabled = ctrl.disabled;
            var readonly = ctrl.readonly;
            var bgcolor = ctrl.bgcolor;
            var frcolor = ctrl.color;
            var font = ctrl.font;
            var align = ctrl.align;
            var justify;
            if !align {
                justify = ', justify="left"';
            } elseif align == "center" {
                justify = ', justify="center"';
            } else {
                justify = ', justify="right"';
            };
            //按钮
            if winctrol.cls == "button" {
                row++;
                var id = ctrlNameList.button + 1;
                ctrlNameList.button = id;
                pycode += 'self.button'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.button'++id++ ' = ttk.Button(self.button'++id++'_frame, text="'++ text ++'")\r\n        ';
                pycode += 'self.button'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.button'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.button'++id++ '.configure(state="disabled")\r\n        '; };
                 
                pycode += 'self.button'++id++'_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
               
            //标签
            if winctrol.cls == "static" {
                row++;
                var id = ctrlNameList.static + 1;
                ctrlNameList.static = id;
                pycode += 'self.label'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.label'++id++ ' = ttk.Label(self.label'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.label'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.label'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.label'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.label'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.label'++id++'.configure(font=self.label'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.label'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.label'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.label'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
               
            //文本框
            if winctrol.cls == "edit" {
                col++;
                var id = ctrlNameList.edit + 1;
                ctrlNameList.edit = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                pycode += 'self.editVar' ++ id ++ " = tk.StringVar(value='"++ winctrol.text ++"')"++'\r\n        ';
                pycode += 'self.edit'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                if winctrol.multiline == 1 {
                    pycode += 'self.edit'++id++ ' = tk.Text(self.edit'++id++'_frame)\r\n        ';
                    pycode += 'self.edit'++id++ '.insert("end", "'++ winctrol.text ++ '")\r\n        ';
                } else {
                    pycode += 'self.edit'++id++ ' = ttk.Entry(self.edit'++id++'_frame, textvariable=self.editVar'++id++ justify ++')\r\n        ';
                }
                pycode += 'self.edit'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if ctrl.password { pycode += 'self.edit'++id++ '.configure(show="*")\r\n        '; };
                if hide { pycode += 'self.edit'++id++ '.place_forget()\r\n        '; };
                if(readonly or disabled) { pycode += 'self.edit'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.edit'++id++'_vscroll = tk.Scrollbar(self.edit'++id++', orient="vertical", command=self.edit'++id++'.yview)\r\n        ';
                    pycode += 'self.edit'++id++'.configure(yscrollcommand=self.edit'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.edit'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.edit'++id++'_hscroll = tk.Scrollbar(self.edit'++id++', orient="horizontal", command=self.edit'++id++'.xview)\r\n        ';
                    pycode += 'self.edit'++id++'.configure(xscrollcommand=self.edit'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.edit'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.edit'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.edit'++id++'.configure(font=self.edit'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.edit'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.edit'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.edit'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
               
            //单选
            if winctrol.cls == "radiobutton" {
                col++;
                var id = ctrlNameList.radio + 1;
                ctrlNameList.radio = id;
                pycode += 'self.radio'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.radio'++id++ ' = ttk.Radiobutton(self.radio'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.radio'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.radio'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.radio'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.radio'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.radio'++id++'.configure(font=self.radio'++id++'_font)\r\n        ';
                };
                pycode += 'self.radio'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
               
            //复选
            if winctrol.cls == "checkbox" {
                col++;
                var id = ctrlNameList.check + 1;
                ctrlNameList.check = id;
                pycode += 'self.check'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.check'++id++ ' = ttk.Checkbutton(self.check'++id++'_frame, text="'++ text ++'"'++ justify ++')\r\n        ';
                pycode += 'self.check'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.check'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.check'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.check'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.check'++id++'.configure(font=self.check'++id++'_font)\r\n        ';
                };
                pycode += 'self.check'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
               
            //图片框
            if winctrol.cls == "picturebox" {
                row++;
                var id = ctrlNameList.pic + 1;
                ctrlNameList.pic = id;
                pycode += 'self.pic'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var picpath = winctrol.background;
                if picpath {
                    pycode += 'self.img' ++ id ++ " = tk.PhotoImage(file=r'"++ picpath.path ++"')"++'\r\n        ';
                    pycode += 'self.pic' ++ id ++ ' = ttk.Label(self.pic'++id++'_frame, image=self.img'++ id ++ justify ++')\r\n        ';
                } else {
                    pycode += 'self.pic'++id++ ' = ttk.Label(self.pic'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.pic'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.pic'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.pic'++id++ '.configure(state="disabled")\r\n        '; };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.pic'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.pic'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.pic'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
              
            //画板
            if winctrol.cls == "plus" {
                row++;
                var id = ctrlNameList.canvas + 1;
                ctrlNameList.canvas = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                var bgcolor = winctrol.backgroundColor;
                pycode += 'self.canvas'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.canvas'++id++ ' = tk.Canvas(self.canvas'++id++'_frame)\r\n        ';
                pycode += 'self.canvas'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.canvas'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.canvas'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.canvas'++id++'_vscroll = tk.Scrollbar(self.canvas'++id++', orient="vertical", command=self.canvas'++id++'.yview)\r\n        ';
                    pycode += 'self.canvas'++id++'.configure(yscrollcommand=self.canvas'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.canvas'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.canvas'++id++'_hscroll = tk.Scrollbar(self.canvas'++id++', orient="horizontal", command=self.canvas'++id++'.xview)\r\n        ';
                    pycode += 'self.canvas'++id++'.configure(xscrollcommand=self.canvas'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.canvas'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    bStr = ..string.slice(bgcolorStr,2,3);
                    gStr = ..string.slice(bgcolorStr,4,5);
                    rStr = ..string.slice(bgcolorStr,6,7);
                    pycode += 'self.canvas'++id++ '.config(background="#'++rStr++gStr++bStr++'")\r\n        ';
                };
                pycode += 'self.canvas'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
              
            //ListBox
            if winctrol.cls == "listbox" {
                row++;
                var id = ctrlNameList.listbox + 1;
                ctrlNameList.listbox = id;
                var vscroll = ctrl.vscroll;
                var hscroll = ctrl.hscroll;
                pycode += 'self.list'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var items = winctrol.items;
                if #items>0 {
                    pycode += 'self.items'++id++' = tk.Variable(value=[';
                    for i,item in items {
                        pycode += '"' ++ item ++'", ';
                    }
                    pycode += '])\r\n        ';
                    pycode += 'self.list'++id++ ' = tk.Listbox(self.list'++id++'_frame, listvariable=self.items'++ id ++ justify ++')\r\n        ';
                       
                } else {
                    pycode += 'self.list'++id++ ' = tk.Listbox(self.list'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.list'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.list'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.list'++id++ '.configure(state="disabled")\r\n        '; };
                if vscroll {
                    pycode += 'self.list'++id++'_vscroll = tk.Scrollbar(self.list'++id++', orient="vertical", command=self.list'++id++'.yview)\r\n        ';
                    pycode += 'self.list'++id++'.configure(yscrollcommand=self.list'++id++'_vscroll.set)\r\n        ';
                    pycode += 'self.list'++id++'_vscroll.pack(side="right", fill="y")\r\n        ';
                };
                if hscroll {
                    pycode += 'self.list'++id++'_hscroll = tk.Scrollbar(self.list'++id++', orient="horizontal", command=self.list'++id++'.xview)\r\n        ';
                    pycode += 'self.list'++id++'.configure(xscrollcommand=self.list'++id++'_hscroll.set)\r\n        ';
                    pycode += 'self.list'++id++'_hscroll.pack(side="bottom", fill="x")\r\n        ';
                };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.list'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.list'++id++'.configure(font=self.list'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.list'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.list'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.list'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
               
            //下拉框
            if winctrol.cls == "combobox" {
                col++;
                var id = ctrlNameList.combobox + 1;
                ctrlNameList.combobox = id;
                pycode += 'self.combobox'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var items = winctrol.items;
                if #items>0 {
                    pycode += 'self.combobox'++id++ '= ttk.Combobox(self.combobox'++id++'_frame, value=[';
                    for i,item in items {
                        pycode += '"' ++ item ++'", ';
                    }
                    pycode += ']'++ justify ++')\r\n        ';
                       
                } else {
                    pycode += 'self.combobox'++id++ ' = ttk.Combobox(self.combobox'++id++'_frame'++ justify ++')\r\n        ';
                }
                pycode += 'self.combobox'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.combobox'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.combobox'++id++ '.configure(state="disabled")\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.combobox'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.combobox'++id++'.configure(font=self.combobox'++id++'_font)\r\n        ';
                };
                if bgcolor {
                    bgcolorStr = ..color.stringify(bgcolor,false);
                    pycode += 'self.combobox'++id++ '.config(background="'++bgcolorStr++'")\r\n        ';
                };
                if frcolor {
                    frcolorStr = ..color.stringify(frcolor,false);
                    pycode += 'self.combobox'++id++ '.config(foreground="'++frcolorStr++'")\r\n        ';
                };
                pycode += 'self.combobox'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
              
            //表格
            if winctrol.cls == "listview" {
                row++;
                var id = ctrlNameList.treeview + 1;
                ctrlNameList.treeview = id;
                pycode += 'self.tree'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.tree'++id++ ' = ttk.Treeview(self.tree'++id++'_frame)\r\n        ';
                pycode += 'self.tree'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.tree'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.tree'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.tree'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
              
            //进度条
            if winctrol.cls == "progress" {
                row++;
                var id = ctrlNameList.progress + 1;
                ctrlNameList.progress = id;
                pycode += 'self.progress'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var max = winctrol.max;
                var value = winctrol.pos;
                pycode += 'self.progress'++id++ ' = ttk.Progressbar(self.progress'++id++'_frame, value='++ value ++', maximum='++ max ++')\r\n        ';
                pycode += 'self.progress'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.progress'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.progress'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.progress'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
               
            //Trackbar
            if winctrol.cls == "trackbar" {
                col++;
                var id = ctrlNameList.trackbar + 1;
                ctrlNameList.trackbar = id;
                pycode += 'self.scale'++id++'_frame = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                var min = winctrol.min;
                var max = winctrol.max;
                var value = winctrol.pos;
                pycode += 'self.scale'++id++ ' = ttk.Scale(self.scale'++id++'_frame, from_='++ min ++', to='++ max ++', value='++ value ++ ')\r\n        ';
                pycode += 'self.scale'++id++ '.place(x=0, y=0, width='++ width ++', height='++ height ++')\r\n        ';
                if hide { pycode += 'self.scale'++id++ '.place_forget()\r\n        '; };
                if disabled { pycode += 'self.scale'++id++ '.configure(state="disabled")\r\n        '; };
                pycode += 'self.scale'++id++ '_frame.grid(column='++col++', row='++row++')\r\n        ';
            };
               
            //GroupBox
            if winctrol.cls == "groupbox" {
                row++;
                var id = ctrlNameList.groupbox + 1;
                ctrlNameList.groupbox = id;
                pycode += 'self.labelframe'++id++ ' = ttk.Labelframe(self.mainframe, text="'++ text ++'", width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.labelframe'++id++ '.grid(column='++col++', row='++row++')\r\n        ';
                if hide { pycode += 'self.labelframe'++id++ '.grid_forget()\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.labelframe'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.labelframe'++id++'.configure(font=self.labelframe'++id++'_font)\r\n        ';
                };
            };
               
            //Frame
            if winctrol.cls == "custom" {
                row++;
                var id = ctrlNameList.frame + 1;
                ctrlNameList.frame = id;
                pycode += 'self.frame'++id++ ' = ttk.Frame(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.frame'++id++ '.grid(column='++col++', row='++row++')\r\n        ';
                if hide { pycode += 'self.frame'++id++ '.grid_forget()\r\n        '; }; 
            };
               
            //Tab
            if winctrol.cls == "tab" {
                row++;
                var id = ctrlNameList.tab + 1;
                ctrlNameList.tab = id;
                pycode += 'self.nb'++id++ ' = ttk.Notebook(self.mainframe, width='++ width ++', height='++ height ++')\r\n        ';
                pycode += 'self.nb'++id++ '.grid(column='++col++', row='++row++')\r\n        ';
                if hide { pycode += 'self.nb'++id++ '.grid_forget()\r\n        '; };
                if font {
                    var italic = font.italic ? 'slant="italic"' : 'slant="roman"';
                    var weight = font.weight==700 ? 'weight="bold"' : 'weight="normal"';
                    var family = 'family="'+font.name+'"';
                    var underline = font.underline ? 'underline=True' : 'underline=False';
                    var size = 'size='++..math.round(font.h*(-3)/4);
                    pycode += 'self.nb'++id++'_font = tkFont.Font(' ++ ..string.join({family; size; weight; italic; underline}, ", ") ++ ')\r\n        ';
                    pycode += 'self.nb'++id++'.configure(font=self.nb'++id++'_font)\r\n        ';
                };
            };
        };
          
        pycode += 'self.mainframe.pack()\r\n';
          
        pycode += '\r\n    ### 功能逻辑部分 ###\r\n        \r\n        \r\n        ';
          
        return pycode;
    };
    
    translateName = function(formStr){
        var pycode = '';
    	var pattern = "(\w+\d?\d?)=\{.*?z=(\d\d?)\}";
    	var results = ..string.matches(formStr, pattern);
    	for i, result in results {
    		var name = result[1];
    		var z = result[2];
    		pycode += '# Z='++z++' -> '++name++'\r\n';
    	};
    	return pycode;
    }
    
        
}
   
/**intellisense()
GUI2Py = 解析aardio界面生成Python Tkinter
GUI2Py.GUI2Tk(.(winform界面窗体) = 返回解析对象
?GUI2Py.GUI2Tk = !GUI2Py_GUI2Tk.
GUI2Py.GUI2Tk() = !GUI2Py_GUI2Tk.
!GUI2Py_GUI2Tk.transfer2root( ) = 组件按place方式布局，返回的代码用于生成主界面
!GUI2Py_GUI2Tk.transfer2place(.( "组件名称" ) = 组件按place方式布局，返回的代码用于生成组件类
!GUI2Py_GUI2Tk.transfer2pack(.( "组件名称" ) = 组件按pack方式布局，返回的代码用于生成组件类\n生成代码后，需手动添加pack参数:\nside=['top','left','bottom','right'], fill=['x','y','both','none']
!GUI2Py_GUI2Tk.transfer2grid(.( "组件名称" ) = 组件按grid方式布局，返回的代码用于生成组件类\n生成代码后，需手动调整grid参数:\ncolumn为所在列，起始为0；row为所在行，起始为0
!GUI2Py_GUI2Tk.translateName(.( winform_DSG ) = 解析窗体设计器代码，返回的Z序与对应控件名称，可用来替换python中的控件名
end intellisense**/
